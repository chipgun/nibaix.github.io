<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta name="renderer" content="webkit"/>
    <meta name="force-rendering" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <script>if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode)) window.location.href="https://support.dmeng.net/upgrade-your-browser.html?referrer="+encodeURIComponent(window.location.href); </script>
    
    
        <link rel="shortcut icon" href="/images/favicon.ico">
    
     
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.13.1/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.2.30/dist/vuetify.min.css" rel="stylesheet">
    
<link rel="stylesheet" href="/css/main.css">

    
    







    
    
          

    
    
    
    
    <title>
        
            PrimeTime-PX Flow | 芝士盒
        
    </title>
    
    
<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="app">
        <v-app>
            <v-content id="page">
                <v-container fluid>
                    <v-row>
                        <v-col cols="2" class="d-none d-md-block">
                            <div id="sidebar" class="float-right">
    <a href="/" rel="home">
        <v-avatar size=96>
            <img id="logo" src="/images/avatar.webp">     
        </v-avatar> 
    </a>
    <v-divider></v-divider>
    <div class="mini-menu">
        <v-btn icon href="/">
            <v-icon>home</v-icon>
        </v-btn>
        <v-btn icon href="/categories/">
            <v-icon>folder</v-icon>
        </v-btn>
        <v-btn icon href="/tags/">
            <v-icon>bookmark</v-icon>
        </v-btn>
        <v-btn icon @click="SetNightMode">
            <v-icon>{{ nightMode }}</v-icon>
        </v-btn>
    </div>
    <v-list id="main-menu" class="font-weight-bold" flat>
        
            
            <v-list-item href="/archives/" link>
            <v-list-item-icon><v-icon>archive</v-icon></v-list-item-icon>
            <v-list-item-content>
                Archives
            </v-list-item-content>
            </v-list-item>
        
            
            <v-list-item href="/about/" link>
            <v-list-item-icon><v-icon>account_circle</v-icon></v-list-item-icon>
            <v-list-item-content>
                About
            </v-list-item-content>
            </v-list-item>
        
            
            <v-list-item href="https://garybear.cn/" link>
            <v-list-item-icon><v-icon>rss_feed</v-icon></v-list-item-icon>
            <v-list-item-content>
                我的博客
            </v-list-item-content>
            </v-list-item>
        
            
            <v-list-item href="https://garybear.cn/hexo-theme-insulin/doc/#/" link>
            <v-list-item-icon><v-icon>insert_drive_file</v-icon></v-list-item-icon>
            <v-list-item-content>
                说明文档
            </v-list-item-content>
            </v-list-item>
        
    </v-list>
    <v-divider></v-divider>
    
        <div class="post-toc">
            <a href="/2022/05/07/PrimeTime-PX-flow/" class="toc-header">Table of Contents</a>
            <div class="toc-content">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Steps-Following-are-the-steps-to-invoke-PT-SI"><span class="toc-number">1.</span> <span class="toc-text">Steps: Following are the steps to invoke PT-SI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-invoke-pt-shell-normally"><span class="toc-number">1.1.</span> <span class="toc-text">0. invoke pt_shell normally</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-set-library-read-gate-level-verilog-netlist-and-spef-file-same-as-in-normal-PT-flow-pwr-is-calc-for-chosen-PVT-corner"><span class="toc-number">1.2.</span> <span class="toc-text">1. set library, read gate level verilog netlist and spef file &#x3D;&gt; same as in normal PT flow. pwr is calc for chosen PVT corner.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-set-power-analysis-so-that-PTPX-license-is-invoked"><span class="toc-number">1.3.</span> <span class="toc-text">2. set power analysis so that PTPX license is invoked</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Read-VCD-file-from-one-of-the-simulation-it-needs-to-be-gate-level-VCD-file-with-back-annotation-of-parasitics"><span class="toc-number">1.4.</span> <span class="toc-text">3. Read VCD file from one of the simulation (it needs to be gate level VCD file with back annotation of parasitics)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-report-power"><span class="toc-number">1.5.</span> <span class="toc-text">4. report power</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reports-power-summary-report"><span class="toc-number">2.</span> <span class="toc-text">Reports: power summary report</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Static-Power"><span class="toc-number">2.1.</span> <span class="toc-text">Static Power</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dynamic-Power"><span class="toc-number">2.2.</span> <span class="toc-text">Dynamic Power</span></a></li></ol></li></ol>
            </div>
        </div>
    

    <div id="footer">
        <div class="footer-social">
            
                
                <v-btn icon href="mailto:kb1000fx@gmail.com" target="_blank">
                    <v-icon>fas fa-envelope</v-icon>
                </v-btn>
            
                
                <v-btn icon href="https://github.com/kb1000fx" target="_blank">
                    <v-icon>fab fa-github</v-icon>
                </v-btn>
            
                
                <v-btn icon href="https://steamcommunity.com/profiles/76561198346798163" target="_blank">
                    <v-icon>fab fa-steam</v-icon>
                </v-btn>
            
                
                <v-btn icon href="https://weibo.com/kb1000fx" target="_blank">
                    <v-icon>fab fa-weibo</v-icon>
                </v-btn>
            
        </div>
        <v-divider></v-divider>
        <div class="footer-content">
            
                <span id="busuanzi_container_site_uv" style="display: none;"> 
                    Total Visitors <span id="busuanzi_value_site_uv"></span>
                </span>
                <br>
            
            <span>Theme: <a target="_blank" rel="noopener" href="https://github.com/kb1000fx/hexo-theme-insulin">Insulin</a></span><br>
            <span>Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a></span><br>
            <span>
                &copy; 2015 - 2025 
                nibaix
            </span>
        </div>
    </div>
</div>

                        </v-col>
                        <v-col cols="12" md="10">
                            <v-row>
  <v-col cols="12" md="8" align-self="end">
    <div id="site-header">
      <div id="site-title">
        <a href="/" rel="home">芝士盒</a>
      </div>
      <div id="site-description"></div>
      <div id="mobile-menu" class="d-block d-md-none">
        <v-text-field label="请输入关键字" data-src="search.xml" v-model="searchHeaderValue" prepend-inner-icon="search" clearable clear-icon="clear" @keydown.enter="EnterSearch(searchHeaderValue,false)"></v-text-field>
        <div class="mobile-mini-menu">
          <v-btn icon href="/">
              <v-icon>home</v-icon>
          </v-btn>
          <v-btn icon href="/categories/">
              <v-icon>folder</v-icon>
          </v-btn>
          <v-btn icon href="/tags/">
              <v-icon>bookmark</v-icon>
          </v-btn>
          <v-btn icon @click="SetNightMode">
              <v-icon>{{ nightMode }}</v-icon>
          </v-btn>
          
            
            <v-btn icon href="/archives/">
              <v-icon>archive</v-icon>
            </v-btn>
          
            
            <v-btn icon href="/about/">
              <v-icon>account_circle</v-icon>
            </v-btn>
          
            
            <v-btn icon href="https://garybear.cn/">
              <v-icon>rss_feed</v-icon>
            </v-btn>
          
            
            <v-btn icon href="https://garybear.cn/hexo-theme-insulin/doc/#/">
              <v-icon>insert_drive_file</v-icon>
            </v-btn>
          
        </div>
      </div>    
    </div>
  </v-col>  
  <v-col cols="4" align-self="end" class="d-none d-md-block">
    <v-col align-self="end">
      <v-text-field label="请输入关键字" data-src="search.xml" v-model="searchHeaderValue" prepend-icon="search" clearable clear-icon="clear" @keydown.enter="EnterSearch(searchHeaderValue,false)"></v-text-field>
    </v-col> 
  </v-col>
</v-row>

                            <v-card class="elevation-2 post-card">
    
    
        <div class="post-header">
  <a class="post-header-title font-weight-medium" href="/2022/05/07/PrimeTime-PX-flow/">PrimeTime-PX Flow</a>
  <div class="post-header-meta">   
    <span>
      <v-icon color="">event</v-icon>
      Posted on:&nbsp;2022-05-07
    </span>
    <span>
      <v-icon color="">event_available</v-icon>
      Edited on:&nbsp;2023-12-07
    </span>
    <span>
      <v-icon color="">folder</v-icon>
      In:&nbsp;<a class="category-link" href="/categories/VLSI/">VLSI</a>
    </span>
    
    <span>
      <v-icon color="">visibility</v-icon>
      Views:&nbsp;<span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
    </span>
    
  </div>
</div>

    
    
    
    
    <div class="post-content typo">
        <p><strong>PT-PX</strong> is PrimeTime with power analysis. It’s a tool within PT (requires separate license of PT-PX). PT-PX combines simulation time window to report power within a window.</p>
<h2 id="Steps-Following-are-the-steps-to-invoke-PT-SI"><a href="#Steps-Following-are-the-steps-to-invoke-PT-SI" class="headerlink" title="Steps: Following are the steps to invoke PT-SI"></a>Steps: Following are the steps to invoke PT-SI</h2><h3 id="0-invoke-pt-shell-normally"><a href="#0-invoke-pt-shell-normally" class="headerlink" title="0. invoke pt_shell normally"></a>0. invoke pt_shell normally</h3><p><code>pt_shell-2012.12-SP3 -f scripts/run_power.tcl |tee logs/run_power.log</code> &#x3D;&gt; can be invoked in gui mode too.<br><strong>run_power.tcl</strong> has following cmds:</p>
<h3 id="1-set-library-read-gate-level-verilog-netlist-and-spef-file-same-as-in-normal-PT-flow-pwr-is-calc-for-chosen-PVT-corner"><a href="#1-set-library-read-gate-level-verilog-netlist-and-spef-file-same-as-in-normal-PT-flow-pwr-is-calc-for-chosen-PVT-corner" class="headerlink" title="1. set library, read gate level verilog netlist and spef file &#x3D;&gt; same as in normal PT flow. pwr is calc for chosen PVT corner."></a>1. set library, read gate level verilog netlist and spef file &#x3D;&gt; same as in normal PT flow. pwr is calc for chosen PVT corner.</h3><span id="more"></span>

<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> search_path <span class="string">&quot;$search_path /db/pdkoa/1533e035/current/diglib/pml48h/synopsys/bin&quot;</span></span><br><span class="line"><span class="keyword">set</span> target_library PML48H_W_85_3_CORE.db</span><br><span class="line"><span class="keyword">set</span> link_library &#123;* PML48H_W_85_3_CORE.db&#125;</span><br><span class="line"></span><br><span class="line">read_verilog /db/ATAGO/.../FinalFiles/digtop_final_route.v =&gt; <span class="keyword">read</span> final routed netlist</span><br><span class="line">current_design digtop</span><br><span class="line">link</span><br><span class="line"></span><br><span class="line">read_parasitics /db/ATAGO/.../FinalFiles/digtop_final_route_max.spef =&gt; <span class="keyword">read</span> max spef <span class="keyword">file</span></span><br></pre></td></tr></table></figure>

<h3 id="2-set-power-analysis-so-that-PTPX-license-is-invoked"><a href="#2-set-power-analysis-so-that-PTPX-license-is-invoked" class="headerlink" title="2. set power analysis so that PTPX license is invoked"></a>2. set power analysis so that PTPX license is invoked</h3><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> power_enable_analysis true</span><br><span class="line"><span class="keyword">set</span> power_analysis_mode averaged</span><br></pre></td></tr></table></figure>

<h3 id="3-Read-VCD-file-from-one-of-the-simulation-it-needs-to-be-gate-level-VCD-file-with-back-annotation-of-parasitics"><a href="#3-Read-VCD-file-from-one-of-the-simulation-it-needs-to-be-gate-level-VCD-file-with-back-annotation-of-parasitics" class="headerlink" title="3. Read VCD file from one of the simulation (it needs to be gate level VCD file with back annotation of parasitics)"></a>3. Read VCD file from one of the simulation (it needs to be gate level VCD file with back annotation of parasitics)</h3><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">read_vcd /sim/ATAGO/.../sim1_max.vcd.gz -strip_path digtop_tb/IDUT/spi_regs -<span class="keyword">time</span> &#123;<span class="number">100489</span> <span class="number">800552</span>&#125; =&gt; strips module of interest so that pwr is reported starting from that module as top level. <span class="keyword">time</span> is in ns.</span><br><span class="line">report_switching_activity &gt; reports/power_swtching.rpt =&gt; to examine tr/sp (see below) and vcd <span class="keyword">file</span> syntax</span><br></pre></td></tr></table></figure>
<h3 id="4-report-power"><a href="#4-report-power" class="headerlink" title="4. report power"></a>4. report power</h3><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#check_power -verbose =&gt; prior to analysis, verifies that analysis i/p are valid</span></span><br><span class="line"><span class="comment">#update_power =&gt; This is needed for RTL VCD or when no vcd provided to propagate activity to nets/registers not annotated from RTL VCD file.</span></span><br><span class="line"><span class="comment">#report_switching_activity =&gt; to examine propagated values of tr/sp</span></span><br><span class="line"><span class="comment">#create_power_waveforms -cycle_accurate =&gt; to show pwr waveform</span></span><br><span class="line">report_power &gt; ./reports/power_summary.rpt</span><br><span class="line">report_power -hier &gt; ./reports/power_hierarchy.rpt</span><br><span class="line"><span class="comment">#report_power -cell -flat -net -hier -verbose -nosplit &gt; power_detail.rpt</span></span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>

<h2 id="Reports-power-summary-report"><a href="#Reports-power-summary-report" class="headerlink" title="Reports: power summary report"></a>Reports: power summary report</h2><h3 id="Static-Power"><a href="#Static-Power" class="headerlink" title="Static Power"></a>Static Power</h3><p>Cell Leakage power. It’s leakage in the cell from VDD to VSS when cell i&#x2F;p is at 0 or 1 (subthreshold lkg from src to drn since gates never turn off completely). It includes gate lkg also (gate lkg is captured only for i&#x2F;p pins for each transistor, as o&#x2F;p pin will finally connect to i&#x2F;p pin of some other transistor. gate lkg is just the current flowing into the gate when i&#x2F;p of gate is 0 or 1). cell lkg pwr number comes from <em>.lib file. Pwr(lkg)&#x3D;V</em>I(subthreshold_lkg)+V*I(gate_lkg).<br>It has a default lkg pwr number for each cell, as well as different lkg pwr numbers depending on diff i&#x2F;p values. ex:<br>cell (AN210_3V) {<br>cell_leakage_power : 1.731915E+00; &#x3D;&gt; default lkg pwr<br>leakage_power () { &#x3D;&gt; we can have many of these conditions for each cell<br>value : 1.718650E+00; &#x3D;&gt; lkg pwr &#x3D; 1.7pW when A&#x3D;1 and B&#x3D;0. pwr unit defined as pw by “leakage_power_unit : “1pW”;” in .lib file<br>when : “A&amp;!B”;<br>}</p>
<h3 id="Dynamic-Power"><a href="#Dynamic-Power" class="headerlink" title="Dynamic Power"></a>Dynamic Power</h3><p><em><strong>A. internal pwr:</strong></em> This includes short ckt pwr when cell o&#x2F;p is switching, as well as pwr due to charging of internal nodes in the cell (due to src&#x2F;drn cap on all o&#x2F;p nodes and gate cap on internal nodes). cell int pwr number comes from <em>.lib file. Pwr(int)&#x3D;Eint</em>Tr where Tr&#x3D;number of toggles&#x2F;time.<br>Just like timing() section, we have internal_power() section for o&#x2F;p pin. It shows int pwr for each combination of i&#x2F;p values (as pwr will change due to short ckt current, drn&#x2F;src cap changing). ex:<br>cell (AN210_3V) {<br>pin (Y) { &#x3D;&gt; pwr is always for o&#x2F;p pin, since i&#x2F;p pin pwr is calcualted separately as switching pwr.<br>internal_power () { &#x3D;&gt; pwr unit is in pJ &#x3D; power unit(pW) * time_unit(s) (it’s energy, not power).<br>related_pin : “A”; &#x3D;&gt; this is when o&#x2F;p changes due to i&#x2F;p pin A changing<br>rise_power (outputpower_cap4_trans5) { … 34.39 .. } &#x3D;&gt; pwr under diff cap load on o&#x2F;p pin, and diff slew on i&#x2F;p pin<br>fall_power (outputpower_cap4_trans5) { … 34.39 .. } &#x3D;&gt; fall_power is when o&#x2F;p pin falls due to pin A rising&#x2F;falling<br>}<br>internal_power () {<br>related_pin : “B”; &#x3D;&gt; this is when o&#x2F;p changes due to i&#x2F;p pin B changing<br>rise_power (outputpower_cap4_trans5) { … 34.39 .. } &#x3D;&gt; rise_power is when o&#x2F;p pin rises due to pin B rising&#x2F;falling<br>fall_power (outputpower_cap4_trans5) { … 40 .. } &#x3D;&gt; 40pJ energy per toggle. Since time is in ns, pwr&#x3D;mw??<br>}<br>}<br>}</p>
<p><em><strong>B. switching pwr:</strong></em> This is due to charging&#x2F;discharging of all the o&#x2F;p load in design. This includes wire cap and gate cap on i&#x2F;p pins which switch whenever o&#x2F;p pin of any gate switches. Pwr(sw)&#x3D;0.5<em>C</em>V^2*Tr. Tr&#x3D;number of toggles&#x2F;time.</p>
<p>Total_pwr &#x3D; Pwr(lkg) + Pwr(int) + Pwr(sw) &#x3D; Pwr(lkg) + Eint<em>Tr + 0.5</em>C<em>V^2</em>Tr (Pwr(lkg) and Eint come from.lib).<br>To calc avg pwr, static probability (Sp) is calcualted for all the nodes to be at 1 or 0. This is then used to calc lkg pwr for each cell. Toggle rate is caluclated for each node to calc dynamic pwr.<br>To calc peak pwr, vcd file is required to analyze events. It’s useful for dynamic IR drop. If vcd file not provided, then tool doesn’t know the seq of events. Merely toggle rate doesn’t tell it whether all nodes toggle at same time or not.<br>When VCd file is not provided, default Tr&#x2F;Sp is applied to starting points (PI, black box o&#x2F;p). default Tr&#x2F;Sp can be modified using (power_default_toggle_rate, power_default_static_probability)</p>

    </div>
    <!--文末结束语-->
    
        <div style="text-align:center;color: #ccc;font-size:24px;"> --- 本文结束 <i class="fas fa-heart"></i> The End --- </div>
    
    <!--页脚广告-->
    
    <v-divider></v-divider>
    
    <div class="post-nav">             
        
            <div class="post-nav-button float-left">
                <v-icon>chevron_left</v-icon>
                <a class="font-weight-bold text-left" href="/2022/05/08/%E4%B8%8A%E6%B5%B7%E6%AF%8F%E6%97%A5%E7%96%AB%E6%83%85%E8%B5%B0%E5%8A%BF2022-5-7/">
                    上海每日疫情走势2022-5-7
                </a>
            </div>
              
          
            <div class="post-nav-button float-right">
                <a class="font-weight-bold text-right" href="/2022/05/07/PrimeTime-and-OCV/">      
                    PrimeTime and Timing Derate
                </a>
                <v-icon>chevron_right</v-icon>
            </div>
        
    </div>
</v-card>



        
                            <div id="mobile-footer" class="d-block d-md-none">
                                <v-divider></v-divider>
                                <div id="mobile-footer-content">
                                    <span>Theme: <a target="_blank" rel="noopener" href="https://github.com/kb1000fx/hexo-theme-insulin">Insulin</a> &nbsp; Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a></span><br>
                                    <span> &copy; 2015 - 2025 nibaix</span>
                                </div>
                            </div>                   
                        </v-col>                                            
                    </v-row>
                </v-container>
            </v-content>
        </v-app>
    </div>
    
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify@2.2.30"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/js-base64@3.5.2/base64.min.js"></script>

<script src="/js/main.js"></script>




    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script src="https://cdn.jsdelivr.net/npm/mermaid@8.4.8/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({
        startOnLoad: true,
        theme: "default"
    });</script>





</body>
</html>