<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="/img/favicon.png">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css">


  
<link rel="stylesheet" href="/css/style.css">


  
  <title>Manage Disk Quota Step by Step - 芝士盒</title>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  <header>
    <nav id="navbar" class="navbar fixed-nav scrolling-navbar">
  <div class="container">
    <div class="mark-wrapper">
      
        <img class="logo" src="/img/avatar.png "/>
       
      <div class="title-mark">芝士盒</div>
    </div>
  
    <button id="menu-btn" class="btn menu-btn" type="button" data-bs-toggle="collapse" data-bs-target="#nav-menu">
      <div class="menu-icon"><span></span><span></span><span></span></div>
    </button>
  
    <div id="nav-menu" class="collapse menu-wrapper">
      <ul>
        
          <li>
            <a href="/">Home </a>
          </li>
        
          <li>
            <a href="/archives">Archives </a>
          </li>
        
          <li>
            <a href="/categories">Category </a>
          </li>
        
          <li>
            <a href="/tags">Tag </a>
          </li>
        
          <li>
            <a href="/about">About </a>
          </li>
        
        <li class="search-icon">
          <button class="btn" data-bs-toggle="modal" data-bs-target="#searchModal" aria-label="Search">
            <i class="fas fa-search"></i>
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

  </header>

  <main>
    <div class="container">
      <div id="main">
        <div class="row py-5">
          <div class="col">
            <div class="row">
  <div class="left-content">
    <article class="post-wrapper markdown-body">
  <h2 class="post-title">
    Manage Disk Quota Step by Step
  </h2>
  <div class="post-meta">
    <time datetime="Invalid date Invalid date ">2022-05-12</time>
    
    
      
        <a class="tag" href="/categories/Linux/">Linux</a> 
       
    
    
      
        <a class="tag" href="/tags/linux/">linux</a> 
       
    
    
  </div>
  
  <div id="content">
    <h2 id="Enable-Quota"><a href="#Enable-Quota" class="headerlink" title="Enable Quota"></a>Enable Quota</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">% <span class="built_in">cat</span> /etc/fstab</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Fri Jul 26 19:45:28 2019</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/dev/vg_chipgun0/lv_root		/		ext4	defaults	1 1</span><br><span class="line">UUID=1d4e1b07-4ab2-46d0-989d-95968627ffa0 /boot                   ext4    defaults        1 2</span><br><span class="line">UUID=7738-A39E          /boot/efi               vfat    <span class="built_in">umask</span>=0077,shortname=winnt 0 0</span><br><span class="line">/dev/mapper/vg_chipgun0-lv_swap swap                    swap    defaults        0 0</span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        0 0</span><br><span class="line">devpts                  /dev/pts                devpts  gid=5,mode=620  0 0</span><br><span class="line">sysfs                   /sys                    sysfs   defaults        0 0</span><br><span class="line">proc                    /proc                   proc    defaults        0 0</span><br><span class="line">/t/iso/rhel-server-6.10-x86_64-dvd.iso	/t/iso/loop		iso9660 defaults,ro,loop 0 0</span><br><span class="line">UUID=<span class="string">&quot;4bcb3b77-8b05-416e-8650-dad4cb38f8ca&quot;</span> /p                   xfs    defaults        0 0</span><br><span class="line">UUID=<span class="string">&quot;1298f072-6db9-46a5-8129-89a40d5fc14f&quot;</span> /l                   xfs    defaults        0 0</span><br><span class="line">UUID=<span class="string">&quot;bb8414b8-181f-43ef-a8f4-0e21841ef4a0&quot;</span> /h                   xfs    defaults        0 0</span><br><span class="line">UUID=<span class="string">&quot;90359d7e-0ad8-41f6-83f1-a168e27c11b3&quot;</span> /p/w   xfs  defaults,usrquota,grpquota      1 2</span><br></pre></td></tr></table></figure>
<p>Looking at the last line of &#x2F;etc&#x2F;fstab above, both <strong>usrquota</strong> and <strong>grpquota</strong> are added in option domain.</p>
<span id="more"></span>

<p>Any changes made in <em>&#x2F;etc&#x2F;fstab</em> file will not apply until next time system reboots. This is also applies on the disk quota options which we have recently added in this file. We have two choices here; either restart the system or remount the associated partition. Wherever possible we should always choose the first option. But in several situations immediate restart is not possible. In that case we can use second option.</p>
<table>
<thead>
<tr>
<th>Domain</th>
<th>Filed</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>UUID&#x3D;””</td>
<td>What to mount</td>
<td>Device which we want to mount. We can use device name, UUID and label in this filed to represent the device.</td>
</tr>
<tr>
<td>&#x2F;p&#x2F;w</td>
<td>Where to mount</td>
<td>The directory in main Linux File System where we want to mount the device.</td>
</tr>
<tr>
<td>xfs</td>
<td>File system</td>
<td>File system type of device.</td>
</tr>
<tr>
<td><strong>defaults,usrquota,grpquota</strong></td>
<td>Options</td>
<td>Mount options which control the mount process. To enable user quota add <strong>usrquota</strong> option and to enable group quota add <strong>grpquota</strong> option.</td>
</tr>
<tr>
<td>0</td>
<td>Dump support</td>
<td>To enable the dump on this device use 1. Use 0 to disable the dump.</td>
</tr>
<tr>
<td>0</td>
<td>Automatic check</td>
<td>Whether this device should be checked while mounting or not. To disable use 0, to enable use 1 (for root partition) or 2 (for all partitions except root partition).</td>
</tr>
</tbody></table>
<h2 id="Remount-File-System"><a href="#Remount-File-System" class="headerlink" title="Remount File System"></a>Remount File System</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% <span class="built_in">sudo</span> mount -o remount /p/w</span><br><span class="line">% mount | grep /p/w </span><br></pre></td></tr></table></figure>

<h2 id="Create-Quota-File"><a href="#Create-Quota-File" class="headerlink" title="Create Quota File"></a>Create Quota File</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% <span class="built_in">sudo</span> quotacheck -cug /p/w</span><br><span class="line">% <span class="built_in">ls</span> /p/w/</span><br><span class="line">aquota.group   aquota.user  lost+found/</span><br></pre></td></tr></table></figure>

<p>This command will create necessary files for quota. Let’s understand this command in detail.</p>
<p><strong>quotacheck</strong> : This command is used to check the quota implementation in partition.</p>
<p><strong>-c</strong> : This option is used to create the quota files in specified partition.</p>
<p><strong>-u</strong> : This option is used to check the user quota.</p>
<p><strong>-g</strong> : This option is used to check the group quota.</p>
<p>Basically this command will check quota entries in specified partition. If <em>aquota.user</em> and <em>aquota.group</em> files are not available in specified partition, it will create them.</p>
<p>We need to run above command only once for each partition where we want to configure the disk quota. Once necessary files are created, following command is used to sync the disk quota database table with current disk usages.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">% <span class="built_in">sudo</span> quotacheck -avug</span><br><span class="line">quotacheck: Your kernel probably supports journaled quota but you are not using it. Consider switching to journaled quota to avoid running quotacheck after an clean shutdown.</span><br><span class="line">quotacheck: Scanning /dev/sdb1 [/p/w] <span class="keyword">done</span></span><br><span class="line">quotacheck: Checked 2 directories and 2 files</span><br></pre></td></tr></table></figure>

<p><strong>-a</strong> : This option is used to check all quota enabled partitions.</p>
<p><strong>-v</strong> : This option is used to print real time updates as command proceeds.</p>
<p><strong>-u</strong> : This option is used to check user disk quota information.</p>
<p><strong>-g</strong> : This option is used to check group disk quota information.</p>
<blockquote>
<p><strong>aquota.user</strong> and <strong>aquota.group</strong> files are used to store quota configuration values for user and group respectively. Quota database keeps track of disk usage. How much space is allowed to a particular user is configured in <strong>aquota.user</strong> file while how much space has been used by that user is tracked in quota database table. The <strong>aquota.user</strong> and <strong>aquota.group</strong> both are binary files which mean we cannot read or write them directly.</p>
</blockquote>
<h2 id="Configure-Quota-Policies"><a href="#Configure-Quota-Policies" class="headerlink" title="Configure Quota Policies"></a>Configure Quota Policies</h2><p>To configure quota policies, we have to define three values; soft limit, hard limit and grace period.</p>
<p><strong>Soft limit</strong>: - This limit is flexible. User or group is allowed to cross this limit temporary.</p>
<p><strong>Hard limit</strong>: - This is fixed limit. User or group is not allowed to cross this limit.</p>
<p><strong>Grace period</strong>: - This is the time period in which user or group is allowed to use additional space beyond the soft limit.</p>
<p>To understand quota policies practically, let’s create some dummy requirements.</p>
<table>
<thead>
<tr>
<th>User &#x2F;Group</th>
<th>Block Size Soft Limit</th>
<th>Block Size Hard Limit</th>
<th>Grace period</th>
<th>Inode Soft Limit</th>
<th>Inode Hard limit</th>
<th>Grace period</th>
</tr>
</thead>
<tbody><tr>
<td>a</td>
<td>100Mb</td>
<td>200Mb</td>
<td>2 Minutes</td>
<td>10</td>
<td>10</td>
<td><strong>Nil</strong></td>
</tr>
<tr>
<td>b</td>
<td>200Mb</td>
<td>200Mb</td>
<td><strong>Nil</strong></td>
<td>10</td>
<td>20</td>
<td>5 hours</td>
</tr>
<tr>
<td>quotatest</td>
<td>1000Mb</td>
<td>1500Mb</td>
<td>1 Day</td>
<td>100</td>
<td>150</td>
<td>5 days</td>
</tr>
</tbody></table>
<p><em>Nil: - If both soft limit and hard limit are same, there is no need to configure this value.</em></p>
<h3 id="Configure-Limit-for-User-and-Group"><a href="#Configure-Limit-for-User-and-Group" class="headerlink" title="Configure Limit for User and Group"></a>Configure Limit for User and Group</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% <span class="built_in">sudo</span> edquota -a</span><br></pre></td></tr></table></figure>

<p>Above command will open user quota configuration file.</p>
<img src="/2022/05/12/manage-disk-quota-step-by-step/ls20-12-edquota-a.jpg" class="">

<p>This file has seven columns</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Filesystem</td>
<td>Partition where this quota will apply</td>
</tr>
<tr>
<td>2</td>
<td>blocks</td>
<td>Number of blocks currently used by this user</td>
</tr>
<tr>
<td>3</td>
<td>soft</td>
<td>Soft block size limit for user</td>
</tr>
<tr>
<td>4</td>
<td>hard</td>
<td>Hard block size limit for user</td>
</tr>
<tr>
<td>5</td>
<td>inodes</td>
<td>Number of inodes currently used by this user</td>
</tr>
<tr>
<td>6</td>
<td>soft</td>
<td>Soft inodes limit for user</td>
</tr>
<tr>
<td>7</td>
<td>hard</td>
<td>hard inodes limit for user</td>
</tr>
</tbody></table>
<p>Let’s update this file</p>
<img src="/2022/05/12/manage-disk-quota-step-by-step/ls20-13-edquota-a.jpg" class="">

<p><em><strong>Default block size is 1Kb. (1block &#x3D; 1Kb).</strong></em></p>
<p>Configure the quota limit for user <strong>b</strong></p>
<img src="/2022/05/12/manage-disk-quota-step-by-step/ls20-14-edquota-b.jpg" class="">

<p>Group quota is also defined in same manner. By default <strong>edquota</strong> command is used to set quota for users. To set quota for group we have to use <strong>–g</strong> option with this command. Let’s define group quota for group <em>quotatest</em>.</p>
<img src="/2022/05/12/manage-disk-quota-step-by-step/ls20-15-edquota-group.jpg" class="">

<h3 id="Configure-Grace-Period"><a href="#Configure-Grace-Period" class="headerlink" title="Configure Grace Period"></a>Configure Grace Period</h3><p>By default grace period is set to seven days. It means user or group will be able to use resources (block size or inodes after soft limit) till seven days. After seven days they will be denied to use any additional resources. We can adjust grace period as per our requirement.</p>
<p>Let’s configure grace period for user <strong>a</strong> and user <strong>b</strong>.</p>
<img src="/2022/05/12/manage-disk-quota-step-by-step/ls20-17-edquota-t-a.jpg" class="">

<img src="/2022/05/12/manage-disk-quota-step-by-step/ls20-18-grace-perid-user-b.jpg" class="">

<p>Configure grace period for group <strong>quotatest</strong>.</p>
<img src="/2022/05/12/manage-disk-quota-step-by-step/ls20-19-grace-period-group.jpg" class="">

<blockquote>
<p>Never put space between value and unit for example “5 days” will be wrong entry, correct entry will be “5days”. A space between value and unit or undefined value will generate <em><strong>edquota cannot read individual grace time from file</strong></em> error message.</p>
</blockquote>
<p>Finally enable quota with following command.</p>
<p><code>quotaon /p/w</code></p>
<h2 id="Test-Disk-Quota"><a href="#Test-Disk-Quota" class="headerlink" title="Test Disk Quota"></a>Test Disk Quota</h2><p>To verify disk quota setup, we can use following commands.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>quota [user name]</td>
<td>To view quota uses by user</td>
</tr>
<tr>
<td>quota –g [group name]</td>
<td>To view quota uses by group</td>
</tr>
<tr>
<td>repquota –a</td>
<td>To view quota uses by all users and groups</td>
</tr>
</tbody></table>
<h2 id="Summary-important-commands-for-quota-management"><a href="#Summary-important-commands-for-quota-management" class="headerlink" title="Summary: important commands for quota management"></a>Summary: important commands for quota management</h2><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>quotacheck</td>
<td>This command is used to check quota implementation and update quota database from file system. This command is also used to create aquota.user and aquota.group files, if they are not created manually.</td>
</tr>
<tr>
<td>edquota</td>
<td>This command is used to configure quota values for user and group.</td>
</tr>
<tr>
<td>quota</td>
<td>This command is used to view the quota uses for specific user or group.</td>
</tr>
<tr>
<td>repquota</td>
<td>This command is used to view the quota uses for all users and group.</td>
</tr>
<tr>
<td>quotaoff</td>
<td>This command is used to turnoff quota temporary.</td>
</tr>
<tr>
<td>quotaon</td>
<td>This command is used to enable quota again if it is disabled.</td>
</tr>
</tbody></table>

  </div>

</article>
  </div>
  <div class="right-content">
    <div id="toc" class="toc-wrapper"></div>
  <div>
</div>


          </div>
        </div>
      </div>
    </div>

     
  <button id="scroll-to-top" class="btn btn-top" aria-label="Scroll To Top">
    <i class="fas fa-arrow-up"></i>
  </button>
 

  </main>

  <div class="footer-wrapper">
  <div class="left-content"></div>
  <div class="right-content">
    <div>Copyright &copy;2025</div>
    <div>Powered By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> - Theme <a target="_blank" rel="noopener" href="https://github.com/thomasyu929/hexo-theme-peomas">Peomas</a></div>
  </div>
</div>

  <div id="searchModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Search</h5>
        <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="input-wrapper">
          <i class="fas fa-search"></i>
          <input id="search" class="search-input" type="text" placeholder="Input content to search..." />
        </div>
        <ul id="result" class="list-group result-wrapper">
        </ul>
      </div>
    </div>
  </div>
</div>

  
<script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/js/bootstrap.min.js"></script>


<script src="/js/prism.js"></script>



  
<script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css">

  
<script src="/js/nprogress.js"></script>



 
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>

  
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css">

 


<script src="/js/event.js"></script>


<script src="/js/search.js"></script>


<script src="/js/plugin.js"></script>



</body>

</html>